import{V as b,l as y,Y as l,r as w,k,h as d,o as i,M as T,w as D,m,O as M,n as R,t as s,x as u,u as E,N as A,_ as I,y as P,i as S,e as h,H as F,D as a,F as B,p as L,f as o}from"./index-DM3KSgk2.js";import{S as C}from"./sidebar-menu-page-D_2zNFuZ-DKHVgHxo.js";const v=b.extend({url:"/api/developer/error",xhr:{updateResolved(e,t){const r=this.model.get("id"),n=this.model.get("resolved");let p="&id="+r+"&resolved="+n;return this._patch("",p,e,t)}}}),x=(e,{list:t})=>{t.refresh()},H=()=>new k({width:"w-full",maxWidth:"max-w-[250px]",class:"",selectFirst:!0,onSelect:(e,{data:t,list:r})=>{const n=e.value;if(n==="all"){t.filter="",r.refresh();return}const p=n.toLowerCase();t.filter=p,r.refresh()},items:[{value:"all",label:"All"},{value:"dev",label:"Dev"},{value:"testing",label:"Testing"},{value:"staging",label:"Staging"},{value:"prod",label:"Prod"}]}),N=()=>y({class:"flex flex-auto flex-col"},[l({class:"flex flex-auto items-center justify-between w-full"},[w({class:"text-3xl font-bold"},"Error Log"),l({class:"flex items-center gap-2"},[l({class:"hidden lg:flex"},[d({variant:"withIcon",class:"text-muted-foreground primary",icon:i.refresh,click:x},"Refresh")]),l({class:"flex lg:hidden mr-0"},[T({content:"Refresh",position:"left"},d({variant:"icon",class:"outline",icon:i.refresh,click:x}))]),H()])])]),f=e=>{try{const t=JSON.parse(e);return JSON.stringify(t,null,"	")}catch{return e}},c=e=>E({class:"whitespace-break-spaces break-all cursor-pointer"},[A({class:"font-mono flex-auto text-sm text-wrap font-normal text-muted-foreground"},e)]),O=e=>new D({title:"[[title]]",description:"Error Details",icon:i.bug,size:"lg",type:"right",hidePrimaryButton:!0,error:e.error,setData(){return new M},beforeSetup(){const t=this.error;this.data.set({...t,title:t.errorMessage.length>20?t.errorMessage.substring(0,20)+"...":t.errorMessage,formattedDate:t.createdAt&&t.createdAt.replace(" ","T")!=="0000-00-00T00:00:00"?m.format("standard",t.createdAt.replace(" ","T"))+" "+m.formatTime(t.createdAt.replace(" ","T"),12):"",formattedQuery:f(t.query),formattedErrorTrace:f(t.errorTrace),formattedBackTrace:f(t.backTrace)})},onClose:()=>{}},[R([s({title:"Error Details"},[u("Line Number","[[errorLine]]")]),s({title:"File"},[c("[[errorFile]]")]),s({title:"Message"},[c("[[errorMessage]]")]),s([u("IP Address","[[errorIp]]"),u("Added","[[formattedDate]]")]),s({title:"Url"},[c("[[url]]")]),s({title:"Query"},[c("[[formattedQuery]]")]),s({title:"Stack Trace"},[c("[[formattedErrorTrace]]")]),s({title:"Back Trace"},[c("[[formattedBackTrace]]")])])]),g=(e,t)=>{new v({id:e,resolved:t}).xhr.updateResolved("",n=>{})},Q=e=>d({variant:"withIcon",class:"outline",icon:i.circleCheck,click(t,r){t.preventDefault(),t.stopPropagation(),g(e.id,1),r.state.resolved=1}},"Resolve"),U=e=>d({variant:"withIcon",class:"outline",icon:i.circleX,click(t,r){t.preventDefault(),t.stopPropagation(),g(e.id,0),r.state.resolved=0}},"Unresolve"),J=I({state(){return{resolved:this.resolved}},render(){const e={id:this.id};return P("resolved",t=>t===1?U(e):Q(e))}}),V=()=>F([h({class:"text-muted-foreground border-b"},[L({class:"hidden md:table-cell"}),o({key:"errorFile",label:"File",class:"max-w-[150px]"}),o({key:"errorLine",label:"Line"}),o({key:"errorMessage",label:"Message",class:"max-w-[150px]"}),o({key:"createdAt",label:"Date",class:"hidden md:table-cell"}),o({key:"env",label:"Env"}),o({key:"errorIp",label:"IP"}),o({key:"resolved",label:"Resolved"})])]),_=(e,t)=>h({class:"items-center px-4 py-2 hover:bg-muted/50 cursor-pointer",click:()=>O({error:e}).open()},[a({class:"p-4 hidden md:table-cell"},[new B({checked:e.selected,class:"mr-2",onChange:()=>t(e)})]),a({class:"p-4 truncate max-w-[150px]"},e.errorFile),a({class:"p-4"},String(e.errorLine)),a({class:"p-4 truncate max-w-[150px]"},e.errorMessage),a({class:"p-4 hidden md:table-cell"},e.createdAt),a({class:"p-4"},e.env),a({class:"p-4"},e.errorIp),a({class:"p-4"},[new J({id:e.id,resolved:e.resolved})])]),j=e=>S({data:e,cache:"list",customHeader:V(),rows:[],limit:50,rowItem:_,key:"id"}),W=()=>{const e=new v({filter:"all"}),t={data:e,update(){this.list&&this.list.refresh()}};return new C(t,[l({class:"grid grid-cols-1"},[l({class:"flex flex-auto flex-col p-6 pt-0 space-y-6 md:space-y-12 md:pt-6 lg:p-8 w-full mx-auto"},[N(),l({class:"flex flex-auto flex-col space-y-2 md:space-y-4"},[l({class:"flex flex-col overflow-x-auto"},[j(e)])])])])])};export{W as ErrorPage,W as default};
