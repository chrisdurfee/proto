var W=Object.defineProperty;var k=e=>{throw TypeError(e)};var _=(e,s,t)=>s in e?W(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var C=(e,s,t)=>_(e,typeof s!="symbol"?s+"":s,t),U=(e,s,t)=>s.has(e)||k("Cannot "+t);var r=(e,s,t)=>(U(e,s,"read from private field"),t?t.call(e):s.get(e)),w=(e,s,t)=>s.has(e)?k("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,t),b=(e,s,t,a)=>(U(e,s,"write to private field"),a?a.call(e,t):s.set(e,t),t),m=(e,s,t)=>(U(e,s,"access private method"),t);import{V as $,_ as B,I as R,y as J,Y as l,v as A,g as h,F as M,o as c,d as g,z as Y,w as K,l as Q,r as X,k as ee,h as P,M as q,i as se,e as T,H as te,D as p,J as ae,p as le,f as x,A as re,B as ie,G as ne,C as oe,E as ce}from"./index-DM3KSgk2.js";import{S as de}from"./sidebar-menu-page-D_2zNFuZ-DKHVgHxo.js";import{R as ue}from"./role-model-UgqUCBfV.js";const F=$.extend({url:"/api/user",xhr:{}}),he=$.extend({url:"/api/user/[[userId]]/role/[[roleId]]",xhr:{}}),me=(e,s,t)=>{const a=new he({userId:s,roleId:t}),i=e?"add":"delete";a.xhr[i]("",u=>{(!u||u.success===!1)&&app.notify({type:"destructive",title:"Error",description:`An error occurred while ${i==="add"?"adding":"removing"} the role.`,icon:c.shield})})},pe=()=>l({class:"flex flex-col space-y-8"},[...[1,2,3,4].map(()=>l({class:"flex flex-col space-y-2"},[l({class:"flex items-center space-x-2"},[A({shape:"circle",width:"w-5",height:"h-5"}),A({width:"w-32",height:"h-4"})]),A({width:"w-40",height:"h-3"})]))]),fe=({hasRole:e,toggleRole:s})=>l({class:"flex flex-col space-y-2",for:["rows",t=>new h({name:t.name,description:t.description},[new M({label:t.name,required:!1,checked:e(t.name),onChange:(a,i)=>{s(t,a)}})])]}),we=B({setData(){return new ue({rows:[]})},state:{loaded:!1},fetch(){this.data.xhr.all("",e=>{this.state.loaded=!0,!(!e||e.success===!1)&&(this.data.rows=e.rows)})},hasRole(e){var t;return(((t=this==null?void 0:this.user)==null?void 0:t.roles)||[]).find(a=>a.name===e)!==void 0},toggleRole(e,s){const t="roles",a=this.user.getIndex(t,"id",e.id);s&&a===-1?this.user.push(t,e):!s&&a!==-1&&this.user.splice(t,a),me(s,this.user.id,e.id)},render(){return this.fetch(),R({legend:"User Roles"},[J("loaded",e=>e?fe({hasRole:this.hasRole.bind(this),toggleRole:this.toggleRole.bind(this)}):pe())])}});var v,N,d,o,n,H,z,D,S,G,Z;const y=class y{constructor(s,t,a){w(this,n);w(this,v);w(this,N);w(this,d);w(this,o,[]);b(this,v,s),b(this,N,t),b(this,d,a)}validate(){return b(this,o,[]),m(this,n,H).call(this),m(this,n,z).call(this),m(this,n,D).call(this),m(this,n,S).call(this),m(this,n,G).call(this),m(this,n,Z).call(this),{valid:r(this,o).length===0,errors:r(this,o)}}};v=new WeakMap,N=new WeakMap,d=new WeakMap,o=new WeakMap,n=new WeakSet,H=function(){r(this,d).length<y.MIN_LENGTH&&r(this,o).push(`Password must be at least ${y.MIN_LENGTH} characters long.`)},z=function(){/[A-Z]/.test(r(this,d))||r(this,o).push("Password must contain at least one uppercase letter.")},D=function(){/[a-z]/.test(r(this,d))||r(this,o).push("Password must contain at least one lowercase letter.")},S=function(){/\d/.test(r(this,d))||r(this,o).push("Password must contain at least one digit.")},G=function(){/[^a-zA-Z0-9]/.test(r(this,d))||r(this,o).push("Password must contain at least one special character (e.g., !@#$%^&*()).")},Z=function(){const s=r(this,d).toLowerCase(),t=r(this,v).toLowerCase(),a=r(this,N).toLowerCase(),i=u=>{for(let f=0;f<=u.length-3;f++){const V=u.substring(f,f+3);if(s.includes(V))return!0}return!1};(i(t)||i(a))&&r(this,o).push("Password must not contain parts of your name.")},C(y,"MIN_LENGTH",12);let E=y;const j=(e,s)=>{if(e!==s)return app.notify({title:"Error",description:"Passwords do not match.",type:"destructive",icon:c.shield}),!1;const t="",a="";return new E(t,a,e).validate().valid?!0:(app.notify({title:"Error",description:"Password does not meet requirements.",type:"destructive"}),!1)},xe=()=>R({legend:"Authentication"},[new h({name:"username",label:"Username",description:"Enter the user's username."},[g({type:"text",placeholder:"e.g. john_doe",required:!0,bind:"username"})]),new h({name:"password",label:"Password",description:"Password must be at least 12 characters long and include uppercase, lowercase, number, and special character."},[g({type:"password",placeholder:"New Password",required:!0,bind:"password",pattern:"^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)(?=.*\\W).{12,}$",title:"Password must be at least 12 characters long and include uppercase, lowercase, number, and special character.","aria-required":!0})]),new h({name:"confirmPassword",label:"Confirm Password",description:"Enter the password again."},[g({type:"password",placeholder:"Confirm New Password",required:!0,bind:"confirmPassword",pattern:"^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)(?=.*\\W).{12,}$",title:"Password must be at least 12 characters long and include uppercase, lowercase, number, and special character.","aria-required":!0,blur:(e,{parent:s})=>j(s.data.password,s.data.confirmPassword)})])]),ge=e=>R({legend:"User Information"},[new h({name:"firstName",label:"First Name",description:"Enter the user's first name."},[g({type:"text",placeholder:"John",required:!0,bind:"firstName"})]),new h({name:"lastName",label:"Last Name",description:"Enter the user's last name."},[g({type:"text",placeholder:"Doe",required:!0,bind:"lastName"})]),new h({name:"email",label:"Email",description:"Enter the user's email address."},[g({type:"email",placeholder:"e.g. john@example.com",required:!0,bind:"email"})]),new h({name:"mobile",label:"Mobile",description:"Enter the user's mobile number."},[Y({placeholder:"e.g. +1234567890",required:!1,bind:"mobile"})])]),be=({isEditing:e,user:s})=>[!e&&xe(),ge(),e&&new we({user:s})],ye=e=>{e.xhr.add("",s=>{if(!s||s.success===!1){app.notify({type:"destructive",title:"Error",description:"An error occurred while adding the user.",icon:c.shield});return}app.notify({type:"success",title:"User Added",description:"The user has been added.",icon:c.check})})},ve=e=>{e.xhr.update("",s=>{if(!s||s.success===!1){app.notify({type:"destructive",title:"Error",description:"An error occurred while updating the user.",icon:c.shield});return}app.notify({type:"success",title:"User Updated",description:"The user has been updated.",icon:c.check})})},O=(e={})=>{const s=e.item||{},t=s.id?"edit":"add",a=new F(s);return new K({data:a,title:t==="edit"?"Edit User":"Add User",icon:t==="edit"?c.pencil.square:c.user.plus,description:t==="edit"?"Update user details.":"Create a new user.",size:"md",type:"right",onClose:()=>e.onClose&&e.onClose(a),onSubmit:({data:i})=>{if(t==="edit")ve(i);else{const u=i.password,f=i.confirmPassword;if(!j(u,f))return;ye(i)}}},[l({class:"flex flex-col lg:p-4 space-y-8"},[l({class:"flex flex-auto flex-col w-full gap-4"},be({isEditing:t==="edit",user:a}))])]).open()},L=(e,{list:s})=>{s.refresh()},I=(e,s)=>O({item:e,onClose:t=>{console.log(s),s.list.refresh()}}),Ne=()=>new ee({width:"w-full",maxWidth:"max-w-[250px]",class:"",selectFirst:!0,onSelect:(e,{data:s,list:t})=>{const a=e.value;if(a==="all"){s.filter="",t.refresh();return}const i=a.toLowerCase();s.filter=i,t.refresh()},items:[{value:"all",label:"All"},{value:"online",label:"Online"},{value:"offline",label:"Offline"},{value:"busy",label:"Busy"},{value:"away",label:"Away"}]}),Pe=()=>Q({class:"flex flex-auto flex-col"},[l({class:"flex flex-auto items-center justify-between w-full"},[X({class:"text-3xl font-bold"},"Users"),l({class:"flex items-center gap-2"},[l({class:"hidden lg:flex"},[P({variant:"withIcon",class:"text-muted-foreground outline",icon:c.refresh,click:L},"Refresh")]),l({class:"flex lg:hidden mr-0"},[q({content:"Refresh",position:"left"},P({variant:"icon",class:"outline",icon:c.refresh,click:L}))]),Ne(),l({class:"hidden lg:flex"},[P({variant:"withIcon",class:"text-muted-foreground primary",icon:c.circlePlus,click:(e,s)=>I(null,s)},"Add User")]),l({class:"flex lg:hidden mr-0"},[q({content:"Add User",position:"left"},P({variant:"icon",class:"outline",icon:c.circlePlus,click:(e,s)=>I(null,s)}))])])])]),Ue=(e,{parent:s})=>O({item:e,onClose:t=>s.list.mingle([t.get()])}),Ae=e=>ae({href:`users/${e.id}`,class:"flex items-center gap-x-4 no-underline text-inherit hover:text-primary"},[l({class:"relative"},[re({src:e.image,alt:e.username,fallbackText:`${e.firstName} ${e.lastName}`}),ie(e.status)]),l({class:"min-w-0 flex-auto"},[l({class:"flex items-center gap-2"},[oe({class:"text-base font-semibold leading-6"},`${e.firstName} ${e.lastName}`)]),ne({class:"truncate text-sm leading-5 text-muted-foreground m-0"},e.username)])]),Ee=e=>{var s;return(s=e.roles)==null?void 0:s.map(t=>ce({type:"gray"},t.name))},Re=(e,s)=>T({class:"items-center px-4 py-2 hover:bg-muted/50 cursor-pointer",click:(t,a)=>Ue(e,a)},[p({class:"p-4 hidden md:table-cell"},[new M({checked:e.selected,class:"mr-2",onChange:()=>s(e)})]),p({class:"p-4 hidden md:table-cell"},String(e.id)),p({class:"p-4"},[Ae(e)]),p({class:"p-4 max-w-[200px] truncate"},e.email),p({class:"p-4 hidden md:table-cell"},e.createdAt),p({class:"p-4 hidden md:table-cell"},e.emailVerifiedAt||"-"),p({class:"p-4 flex flex-wrap gap-2"},Ee(e))]),ke=()=>te([T({class:"text-muted-foreground border-b"},[le({class:"hidden md:table-cell"}),x({key:"id",label:"ID",class:"hidden md:table-cell"}),x({key:"name",label:"Name"}),x({key:"email",label:"Email"}),x({key:"createdAt",label:"Created At"}),x({key:"emailVerifiedAt",label:"Email Verified"}),x({key:"roles",label:"Roles"})])]),Ce=e=>se({data:e,cache:"list",customHeader:ke(),rows:[],limit:50,rowItem:Re,key:"id"}),Me=()=>{const e=new F({filter:{status:"all"}}),s={data:e,update(){this.list&&this.list.refresh()}};return new de(s,[l({class:"grid grid-cols-1"},[l({class:"flex flex-auto flex-col p-6 pt-0 space-y-6 md:space-y-12 md:pt-6 lg:p-8 w-full mx-auto"},[Pe(),l({class:"flex flex-auto flex-col space-y-2 md:space-y-4"},[l({class:"flex flex-col overflow-x-auto"},[Ce(e)])])])])])};export{Me as UserPage,Me as default};
